<?xml version="1.0" encoding="utf-8" ?>
<Defs>
	
	<!-- Plasma Extractor ================================================================ -->
	<ThingDef ParentName="BuildingBase">
		<defName>kotor_plasmaextractor</defName>
		<label>plasma extractor</label>
		<description>Mines into the planets crust to extract unrefined plasma</description>
		<graphicData>
			<texPath>plasma_system/Plasma_Extractor</texPath>
			<graphicClass>Graphic_Single</graphicClass>
			<drawSize>(4, 4)</drawSize>
			<shadowData>
				<volume>(1.5, 1.0, 0.2)</volume>
				<offset>(0.0, 0.0, -0.8)</offset>
			</shadowData>
			<drawOffset>(0,0,0.25)</drawOffset>
		</graphicData>
		<costList>
			<Steel>250</Steel>
			<kotor_czerkatechComponent>2</kotor_czerkatechComponent>
		</costList>
		<building>
			<destroySound>BuildingDestroyed_Metal_Big</destroySound>
		</building>
		<comps>
			<li Class="CompProperties_Power">
				<compClass>CompPowerTrader</compClass>
				<basePowerConsumption>500</basePowerConsumption>
			</li>
			<li Class="CompProperties_Breakdownable"/>
			<li Class="CompProperties_Flickable"/>
			<li Class="CompProperties_Spawner">
				<requiresPower>true</requiresPower>
				<thingToSpawn>kotor_unrefinedplasma</thingToSpawn>
				<spawnCount>10</spawnCount>
				<spawnIntervalRange><min>600000</min><max>600000</max></spawnIntervalRange>
				<writeTimeLeftToSpawn>true</writeTimeLeftToSpawn>
				<showMessageIfOwned>true</showMessageIfOwned>
			</li>
				<li Class="CompProperties_Explosive">
				<explosiveRadius>15</explosiveRadius>
				<explosiveDamageType>Flame</explosiveDamageType>
			</li>
		</comps>
		<altitudeLayer>Building</altitudeLayer>
		<statBases>
			<MarketValue>1000</MarketValue>
			<MaxHitPoints>100</MaxHitPoints>
			<Flammability>2.0</Flammability>
			<Beauty>-10</Beauty>
			<Mass>35</Mass>
			<WorkToBuild>8000</WorkToBuild>
		</statBases>
		<thingSetMakerTags>
			<li>RewardStandardCore</li>
		</thingSetMakerTags>
		<tickerType>Normal</tickerType>
		<size>(1, 3)</size>
		<fillPercent>1.0</fillPercent>
		<leaveResourcesWhenKilled>false</leaveResourcesWhenKilled>
		<terrainAffordanceNeeded>Medium</terrainAffordanceNeeded>
		<passability>Impassable</passability>
		<rotatable>false</rotatable>
		<canOverlapZones>false</canOverlapZones>
		<tradeability>Sellable</tradeability>
		<tradeTags>
			<li>ExoticBuilding</li>
		</tradeTags>
		<researchPrerequisites>
			<li>KOTOR_Research_plasma</li>
		</researchPrerequisites>
		<designationCategory>KOTOR_BuildTab</designationCategory>
		<uiIconScale>0.6</uiIconScale>
	</ThingDef>
	
	<!-- Unrefined Plasma ================================================================ -->
	<ThingDef ParentName="ResourceBase">
		<defName>kotor_unrefinedplasma</defName>
		<label>unrefined plasma</label>
		<description>A volatile substance that can be used to generate power or condensed into high powered energy projectices. Needs to be refined to have the most use.</description>
		<possessionCount>20</possessionCount>
		<tickerType>Normal</tickerType>
		<graphicData>
			<texPath>plasma_system/Unrefined_Plasma</texPath>
			<graphicClass>Graphic_StackCount</graphicClass>
			<drawSize>0.85</drawSize>
		</graphicData>
		<stackLimit>150</stackLimit>
		<healthAffectsPrice>false</healthAffectsPrice>
		<intricate>true</intricate> <!-- Not returned to player when product made of this is smelted. -->
		<statBases>
			<MarketValue>3.0</MarketValue>
			
			<MaxHitPoints>10</MaxHitPoints>
			<Mass>0.1</Mass>
			<Flammability>5.0</Flammability>
			<DeteriorationRate>2.0</DeteriorationRate>
		</statBases>
		<thingCategories>
			<li>Manufactured</li>
		</thingCategories>
		<comps>
			<li Class="CompProperties_Explosive">
				<explosiveRadius>2</explosiveRadius>
				<explosiveDamageType>Flame</explosiveDamageType>
				<explosiveExpandPerStackcount>0.037</explosiveExpandPerStackcount>
				<startWickOnDamageTaken>
					<li>Flame</li>
				</startWickOnDamageTaken>
				<startWickHitPointsPercent>0.333</startWickHitPointsPercent>
				<preExplosionSpawnThingDef>Filth_Fuel</preExplosionSpawnThingDef>
				<preExplosionSpawnChance>1</preExplosionSpawnChance>
				<wickTicks>70~150</wickTicks>
			</li>
		</comps>
		<allowedArchonexusCount>100</allowedArchonexusCount>
	</ThingDef>

	<!-- Plasma Core ================================================================ -->
	<ThingDef ParentName="BuildingBase">
		<defName>kotor_plasmacore</defName>
		<label>plasma core generator</label>
		<description>Produces power by consuming unrefined plasma. Must be periodically refueled by hand.</description>
		<thingClass>Building</thingClass>
		<drawerType>MapMeshAndRealTime</drawerType>
		<graphicData>
			<texPath>plasma_system/Plasma_Core</texPath>
			<graphicClass>Graphic_Single</graphicClass>
			<drawSize>(2,2)</drawSize>
			<shadowData>
			<volume>(1,1,1)</volume>
			<offset>(-0.2,0,-0.3)</offset>
			</shadowData>
		</graphicData>
		<altitudeLayer>Building</altitudeLayer>
		<passability>PassThroughOnly</passability>
		<pathCost>50</pathCost>
		<blockWind>true</blockWind>
		<fillPercent>1.0</fillPercent>
		<rotatable>false</rotatable>
		<statBases>
			<MaxHitPoints>500</MaxHitPoints>
			<WorkToBuild>3500</WorkToBuild>
			<Flammability>2.0</Flammability>
			<Beauty>-10</Beauty>
		</statBases>
		<tickerType>Normal</tickerType>
		<canOverlapZones>false</canOverlapZones>
		<size>(2,2)</size>
		<building>
			<destroySound>BuildingDestroyed_Metal_Medium</destroySound>
		</building>
		<costList>
			<Steel>250</Steel>
			<kotor_czerkatechComponent>2</kotor_czerkatechComponent>
		</costList>
		<comps>
			<li Class="CompProperties_Power">
				<compClass>CompPowerPlant</compClass>
				<basePowerConsumption>-1500</basePowerConsumption>
				<transmitsPower>true</transmitsPower>
				<soundAmbientProducingPower>ChemfuelFiredGenerator_Ambience</soundAmbientProducingPower>
			</li>
			<li Class="CompProperties_Flickable" />
			<li Class="CompProperties_Refuelable">
				<fuelConsumptionRate>10</fuelConsumptionRate>
				<fuelCapacity>50.0</fuelCapacity>
				<fuelFilter>
					<thingDefs>
						<li>kotor_unrefinedplasma</li>
					</thingDefs>
				</fuelFilter>
				<showAllowAutoRefuelToggle>true</showAllowAutoRefuelToggle>
			</li>
			<li Class="CompProperties_Glower">
				<glowRadius>3</glowRadius>
				<glowColor>(234,49,221,0)</glowColor>
			</li>
			<li Class="CompProperties_HeatPusher">
				<compClass>CompHeatPusherPowered</compClass>
				<heatPerSecond>15</heatPerSecond>
			</li>
			<li Class="CompProperties_Breakdownable"/>
			<li Class="CompProperties_Explosive">
				<explosiveRadius>5</explosiveRadius>
				<explosiveExpandPerFuel>1.25</explosiveExpandPerFuel>
				<explosiveDamageType>Flame</explosiveDamageType>
				<destroyThingOnExplosionSize>2</destroyThingOnExplosionSize>
				<startWickHitPointsPercent>0.333</startWickHitPointsPercent>
				<preExplosionSpawnThingDef>Filth_Fuel</preExplosionSpawnThingDef>
				<preExplosionSpawnChance>1</preExplosionSpawnChance>
				<wickTicks>70~150</wickTicks>
			</li>
		</comps>
		<terrainAffordanceNeeded>Medium</terrainAffordanceNeeded>
		<designationCategory>KOTOR_BuildTab</designationCategory>
		<uiOrder>2100</uiOrder>
		<constructEffect>ConstructMetal</constructEffect>
		<researchPrerequisites>
			<li>KOTOR_Research_plasma</li>
		</researchPrerequisites>
		<constructionSkillPrerequisite>6</constructionSkillPrerequisite>
	</ThingDef>

	<!-- Plasma Refinery ================================================================ -->
	<ThingDef ParentName="BenchBase">
		<defName>kotor_plasmarefinery</defName>
		<label>plasma refinery</label>
		<description>Refines the unstable plasma into a versatile, safer form.</description>
		<thingClass>Building_WorkTable</thingClass>
		<altitudeLayer>Building</altitudeLayer>
		<passability>PassThroughOnly</passability>
		<pathCost>50</pathCost>
		<statBases>
			<MaxHitPoints>400</MaxHitPoints>
			<WorkToBuild>3000</WorkToBuild>
			<Flammability>1.0</Flammability>
		</statBases>
		<size>(7,5)</size>
		<costList>
			<Steel>450</Steel>
			<kotor_czerkatechComponent>3</kotor_czerkatechComponent>
		</costList>
		<comps>
			<li Class="CompProperties_Power">
				<compClass>CompPowerTrader</compClass>
				<basePowerConsumption>500</basePowerConsumption>
				<shortCircuitInRain>true</shortCircuitInRain>
			</li>
			<li Class="CompProperties_Flickable"/>
			<li Class="CompProperties_Breakdownable"/>
		</comps>
		<castEdgeShadows>false</castEdgeShadows>
		<staticSunShadowHeight>0</staticSunShadowHeight>
		<graphicData>
			<texPath>plasma_system/Plasma_Refinery</texPath>
			<graphicClass>Graphic_Multi</graphicClass>
			<shaderType>CutoutComplex</shaderType>
			<drawSize>(7,7)</drawSize>
			<shadowData>
				<volume>(2.22, 0.8, 0.62)</volume>
				<offset>(0, 0, -0.13)</offset>
			</shadowData>
			<damageData>
				<rect>(0.3,0.1,2.4,1.8)</rect>
			</damageData>
		</graphicData>
		<inspectorTabs>
			<li>ITab_Bills</li>
		</inspectorTabs>
		<building>
			<spawnedConceptLearnOpportunity>BillsTab</spawnedConceptLearnOpportunity>
			<buildingTags>
				<li>Production</li>
			</buildingTags>
		</building>
		<fillPercent>0.5</fillPercent>
		<hasInteractionCell>true</hasInteractionCell>
		<interactionCellOffset>(2,0,-3)</interactionCellOffset>
		<terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
		<designationCategory>KOTOR_BuildTab</designationCategory>
		<surfaceType>Item</surfaceType>
		<constructionSkillPrerequisite>6</constructionSkillPrerequisite>
		<placeWorkers>
			<li>PlaceWorker_PreventInteractionSpotOverlap</li>
			<li>PlaceWorker_ReportWorkSpeedPenalties</li>
		</placeWorkers>
		<researchPrerequisites>
			<li>KOTOR_Research_plasma</li>
		</researchPrerequisites>
	</ThingDef>
	
	<WorkGiverDef>
		<defName>kotor_plasmarefinery_WorkGiver</defName>
		<label>make things at Plasma Furnace</label>
		<giverClass>WorkGiver_DoBill</giverClass>
		<workType>Smithing</workType>
		<priorityInType>75</priorityInType>
		<fixedBillGiverDefs>
			<li>kotor_plasmarefinery</li>
		</fixedBillGiverDefs>
		<verb>work</verb>
		<gerund>working at</gerund>
		<requiredCapacities>
			<li>Manipulation</li>
		</requiredCapacities>
		<prioritizeSustains>true</prioritizeSustains>
	</WorkGiverDef>	

	<!-- Refined Plasma ================================================================ -->
	<ThingDef ParentName="ResourceBase">
		<defName>kotor_plasma</defName>
		<label>refined plasma</label>
		<description>A volatile substance that can be used to generate power or condensed into high powered energy projectices.</description>
		<possessionCount>20</possessionCount>
		<tickerType>Normal</tickerType>
		<graphicData>
			<texPath>plasma_system/Plasma</texPath>
			<graphicClass>Graphic_StackCount</graphicClass>
			<drawSize>0.85</drawSize>
		</graphicData>
		<stackLimit>150</stackLimit>
		<healthAffectsPrice>false</healthAffectsPrice>
		<intricate>true</intricate> <!-- Not returned to player when product made of this is smelted. -->
		<statBases>
			<MarketValue>3.5</MarketValue>
			
			<MaxHitPoints>15</MaxHitPoints>
			<Mass>0.1</Mass>
			<Flammability>1.0</Flammability>
			<DeteriorationRate>1.0</DeteriorationRate>
		</statBases>
		<thingCategories>
			<li>Manufactured</li>
		</thingCategories>
		<comps>
			<li Class="CompProperties_Explosive">
				<explosiveRadius>1</explosiveRadius>
				<explosiveDamageType>Flame</explosiveDamageType>
				<explosiveExpandPerStackcount>0.037</explosiveExpandPerStackcount>
				<startWickOnDamageTaken>
					<li>Flame</li>
				</startWickOnDamageTaken>
				<startWickHitPointsPercent>0.333</startWickHitPointsPercent>
				<preExplosionSpawnThingDef>Filth_Fuel</preExplosionSpawnThingDef>
				<preExplosionSpawnChance>1</preExplosionSpawnChance>
				<wickTicks>70~150</wickTicks>
			</li>
		</comps>
		<allowedArchonexusCount>100</allowedArchonexusCount>
		<tradeTags>
		  <li>guy762TT_KotORFuel_common</li>
		</tradeTags>
	</ThingDef>

	<!-- Recipe -->
	<RecipeDef>
		<defName>kotor_plasma_recipe</defName>
		<label>refine plasma</label>
		<description>refine plasma</description>
		<jobString>refining plasma.</jobString>
		<workSpeedStat>GeneralLaborSpeed</workSpeedStat>
		<effectWorking>Cook</effectWorking>
		<soundWorking>Recipe_Machining</soundWorking>
		<workAmount>3000</workAmount>
		<ingredients>
			<li>
				<filter>
				<thingDefs>
					<li>kotor_unrefinedplasma</li>
				</thingDefs>
				</filter>
				<count>1</count>
			</li>
		</ingredients>
		<products>
			<kotor_plasma>1</kotor_plasma>
		</products>
		<skillRequirements>
			<Crafting>10</Crafting>
		</skillRequirements>
		<workSkill>Crafting</workSkill>
		<displayPriority>10</displayPriority>
		<recipeUsers>
			<li>kotor_plasmarefinery</li>
		</recipeUsers>
	</RecipeDef>	
	
	<!-- Plasma Catalyst ================================================================ -->
	<ThingDef ParentName="BuildingBase">
		<defName>kotor_plasmacatalyst</defName>
		<label>plasma Catalyst</label>
		<description>Produces power by consuming plasma. Must be refueled by hand.</description>
		<thingClass>Building</thingClass>
		<drawerType>MapMeshAndRealTime</drawerType>
		<graphicData>
			<texPath>plasma_system/Plasma_Catalyst</texPath>
			<graphicClass>Graphic_Single</graphicClass>
			<drawSize>(4,4)</drawSize>
			<shadowData>
			<volume>(1.93,1,1.69)</volume>
			<offset>(-0.03,0,-0.1)</offset>
			</shadowData>
		</graphicData>
		<altitudeLayer>Building</altitudeLayer>
		<passability>PassThroughOnly</passability>
		<pathCost>50</pathCost>
		<blockWind>true</blockWind>
		<fillPercent>1.0</fillPercent>
		<rotatable>false</rotatable>
		<statBases>
			<MaxHitPoints>1500</MaxHitPoints>
			<WorkToBuild>7500</WorkToBuild>
			<Flammability>5.0</Flammability>
			<Beauty>-10</Beauty>
		</statBases>
		<tickerType>Normal</tickerType>
		<canOverlapZones>false</canOverlapZones>
		<size>(4,4)</size>
		<building>
			<destroySound>BuildingDestroyed_Metal_Medium</destroySound>
		</building>
		<costList>
			<Steel>500</Steel>
			<kotor_czerkatechComponent>8</kotor_czerkatechComponent>
		</costList>
		<comps>
			<li Class="CompProperties_Power">
				<compClass>CompPowerPlant</compClass>
				<basePowerConsumption>-5000</basePowerConsumption>
				<transmitsPower>true</transmitsPower>
				<soundAmbientProducingPower>ChemfuelFiredGenerator_Ambience</soundAmbientProducingPower>
			</li>
			<li Class="CompProperties_Flickable" />
			<li Class="CompProperties_Refuelable">
				<fuelConsumptionRate>15</fuelConsumptionRate>
				<fuelCapacity>150.0</fuelCapacity>
				<fuelFilter>
					<thingDefs>
						<li>kotor_plasma</li>
					</thingDefs>
				</fuelFilter>
				<showAllowAutoRefuelToggle>true</showAllowAutoRefuelToggle>
			</li>
			<li Class="CompProperties_Glower">
				<glowRadius>8</glowRadius>
				<glowColor>(234,49,221,0)</glowColor>
			</li>
			<li Class="CompProperties_HeatPusher">
				<compClass>CompHeatPusherPowered</compClass>
				<heatPerSecond>25</heatPerSecond>
			</li>
			<li Class="CompProperties_Breakdownable"/>
			<li Class="CompProperties_Explosive">
				<explosiveRadius>15</explosiveRadius>
				<explosiveExpandPerFuel>1.25</explosiveExpandPerFuel>
				<explosiveDamageType>Flame</explosiveDamageType>
				<destroyThingOnExplosionSize>2</destroyThingOnExplosionSize>
				<startWickHitPointsPercent>0.333</startWickHitPointsPercent>
				<preExplosionSpawnThingDef>Filth_Fuel</preExplosionSpawnThingDef>
				<preExplosionSpawnChance>1</preExplosionSpawnChance>
				<wickTicks>70~150</wickTicks>
			</li>
		</comps>
		<terrainAffordanceNeeded>Medium</terrainAffordanceNeeded>
		<designationCategory>KOTOR_BuildTab</designationCategory>
		<uiOrder>2100</uiOrder>
		<constructEffect>ConstructMetal</constructEffect>
		<researchPrerequisites>
			<li>KOTOR_Research_plasma</li>
		</researchPrerequisites>
		<constructionSkillPrerequisite>8</constructionSkillPrerequisite>
	</ThingDef>

	
  
</Defs>
